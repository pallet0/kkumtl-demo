<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê¿ˆí‹€ - ë‚˜ë§Œì˜ ì†Œì„¤ ì“°ê¸°</title>
    <link rel="stylesheet" href="css/styles.css">
    
    <!-- Mobile Responsive Styles -->
    <style>
        @media (max-width: 768px) {
            /* Reorder main content for mobile: header -> buttons -> editor -> parameters */
            .main-content {
                flex-direction: column;
                overflow-y: auto;
            }
            
            /* App container adjustments */
            #app-container {
                height: auto;
                min-height: 100vh;
                overflow-y: auto;
            }
            
            body {
                overflow-y: auto;
                height: auto;
            }
            
            /* Header - stays at top */
            .app-header {
                flex-wrap: wrap;
                height: auto;
                padding: 12px 16px;
                gap: 8px;
            }
            
            .header-left {
                width: 100%;
                justify-content: center;
            }
            
            .header-center {
                width: 100%;
                justify-content: center;
            }
            
            .header-right {
                width: 100%;
                justify-content: center;
                flex-wrap: wrap;
                gap: 10px;
            }
            
            /* Mobile Generate Buttons - show prominently below header */
            .mobile-generate-buttons {
                display: flex !important;
                flex-direction: row;
                justify-content: center;
                gap: 12px;
                padding: 12px 16px;
                background: white;
                border-bottom: 1px solid var(--border-color);
                flex-wrap: wrap;
            }
            
            .mobile-generate-buttons .btn {
                flex: 1;
                min-width: 120px;
                max-width: 180px;
            }
            
            /* Hide toolbar center buttons on mobile (moved to mobile-generate-buttons) */
            .editor-toolbar .toolbar-center {
                display: none;
            }
            
            /* Simplify toolbar for mobile */
            .editor-toolbar {
                height: auto;
                padding: 8px 12px;
                justify-content: space-between;
            }
            
            .toolbar-left, .toolbar-right {
                gap: 4px;
            }
            
            /* Editor container - comes first after buttons */
            .editor-container {
                order: -1;
                min-height: 50vh;
            }
            
            .editor-wrapper {
                padding: 10px;
            }
            
            .editor-textarea {
                padding: 16px;
                font-size: 16px;
                min-height: 300px;
            }
            
            /* Sidebars - show as sections below editor */
            .sidebar {
                width: 100%;
                order: 2;
                border-right: none;
                border-left: none;
                border-top: 1px solid var(--border-color);
                max-height: none;
            }
            
            .sidebar-left {
                display: block !important;
                order: 2;
            }
            
            .sidebar-right {
                display: block !important;
                order: 3;
            }
            
            /* Make setting groups more compact on mobile */
            .sidebar-section {
                margin-bottom: 15px;
                padding-bottom: 15px;
            }
            
            .setting-group {
                margin-bottom: 12px;
            }
            
            /* Preset buttons - 2 columns on mobile */
            .preset-buttons {
                grid-template-columns: repeat(2, 1fr);
            }
            
            /* Editor footer adjustments */
            .editor-footer {
                flex-wrap: wrap;
                height: auto;
                padding: 8px 12px;
                gap: 8px;
            }
            
            .footer-left, .footer-center, .footer-right {
                width: 100%;
                text-align: center;
            }
        }
        
        /* Hide mobile generate buttons on desktop */
        .mobile-generate-buttons {
            display: none;
        }
        
        /* Mobile Survey Icons */
        .mobile-survey-icons {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-left: auto;
            padding: 4px 8px;
            background: var(--bg-secondary, #edf2f7);
            border-radius: 8px;
        }
        
        .survey-icon-btn.mobile {
            padding: 8px 12px;
            border: 1px solid var(--border-color, #e2e8f0);
            background: white;
        }
        
        .survey-icon-btn.mobile:hover {
            background: var(--bg-secondary, #edf2f7);
        }
        
        /* Small mobile adjustments */
        @media (max-width: 480px) {
            .app-title {
                font-size: 18px;
            }
            
            .app-subtitle {
                font-size: 11px;
            }
            
            .mobile-generate-buttons {
                flex-direction: column;
                align-items: center;
            }
            
            .mobile-generate-buttons .btn {
                width: 100%;
                max-width: 250px;
            }
            
            .survey-icons {
                display: none;
            }
        }
    </style>
    
    <!-- Google Fonts for novel-like typography -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Crimson+Text:ital,wght@0,400;0,600;0,700;1,400&family=Lora:ital,wght@0,400;0,500;0,600;1,400&family=Merriweather:ital,wght@0,300;0,400;0,700;1,300;1,400&family=Noto+Sans+JP:wght@300;400;500&family=Noto+Sans+KR:wght@300;400;500&display=swap" rel="stylesheet">
</head>
<body>
    <!-- ========================================
         PASSWORD MODAL - For API Key Decryption
         ======================================== -->
    <div id="password-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>ğŸ” ë¹„ë°€ë²ˆí˜¸ ì…ë ¥</h2>
            </div>
            <div class="modal-body">
                <p>AI ê¸€ì“°ê¸° ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ë ¤ë©´ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.</p>
                <input type="password" id="password-input" placeholder="ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”..." autocomplete="off">
                <div id="password-error" class="error-message hidden"></div>
            </div>
            <div class="modal-footer">
                <button id="password-submit" class="btn btn-primary">ì ê¸ˆ í•´ì œ</button>
            </div>
        </div>
    </div>

    <!-- ========================================
         SURVEY MODAL - Feedback Collection
         ======================================== -->
    <div id="survey-modal" class="modal hidden">
        <div class="modal-content survey-modal-content">
            <div class="modal-header">
                <h2>ğŸ“ í”¼ë“œë°± ë‚¨ê¸°ê¸°</h2>
                <button id="survey-close" class="modal-close-btn" aria-label="Close">&times;</button>
            </div>
            <div class="modal-body">
                <!-- Satisfaction Question -->
                <div class="survey-question">
                    <label class="survey-label">ì´ ì„œë¹„ìŠ¤ê°€ ë§Œì¡±ìŠ¤ëŸ¬ìš°ì‹ ê°€ìš”?</label>
                    <div class="survey-satisfaction">
                        <button id="survey-satisfactory" class="satisfaction-btn" data-value="satisfactory">
                            <span class="thumbs-icon large">ğŸ‘</span>
                            <span>ë§Œì¡±</span>
                        </button>
                        <button id="survey-unsatisfactory" class="satisfaction-btn" data-value="unsatisfactory">
                            <span class="thumbs-icon large">ğŸ‘</span>
                            <span>ë¶ˆë§Œì¡±</span>
                        </button>
                    </div>
                </div>

                <!-- Likes Reading Novels Question -->
                <div class="survey-question">
                    <label class="survey-label">ì†Œì„¤/ì›¹ì†Œì„¤/ë¼ì´íŠ¸ë…¸ë²¨ ì½ê¸°ë¥¼ ì¢‹ì•„í•˜ì‹œë‚˜ìš”?</label>
                    <div class="toggle-group survey-toggle">
                        <span class="toggle-label-text">ì•„ë‹ˆì˜¤</span>
                        <label class="toggle-switch">
                            <input type="checkbox" id="survey-likes-novels">
                            <span class="toggle-slider"></span>
                        </label>
                        <span class="toggle-label-text">ì˜ˆ</span>
                    </div>
                </div>

                <!-- Email Question -->
                <div class="survey-question">
                    <label class="survey-label" for="survey-email">ì´ë©”ì¼ ì£¼ì†Œ (í›„ì† ì—°ë½ìš©)</label>
                    <input type="email" id="survey-email" class="survey-input" placeholder="your@email.com">
                </div>

                <!-- Suggestions Question -->
                <div class="survey-question">
                    <label class="survey-label" for="survey-suggestions">ê±´ì˜ì‚¬í•­ì´ë‚˜ í”¼ë“œë°±ì´ ìˆìœ¼ì‹ ê°€ìš”?</label>
                    <textarea id="survey-suggestions" class="survey-textarea" placeholder="ì˜ê²¬ì„ ììœ ë¡­ê²Œ ì‘ì„±í•´ì£¼ì„¸ìš”..." rows="4"></textarea>
                </div>

                <div id="survey-error" class="error-message hidden"></div>
            </div>
            <div class="modal-footer">
                <button id="survey-submit" class="btn btn-primary">í”¼ë“œë°± ì œì¶œ</button>
            </div>
        </div>
    </div>

    <!-- ========================================
         MAIN APPLICATION CONTAINER
         ======================================== -->
    <div id="app-container" class="hidden">
        
        <!-- ========================================
             HEADER - Application Title & Status
             ======================================== -->
        <header class="app-header">
            <div class="header-left">
                <h1 class="app-title">ğŸ“– ê¿ˆí‹€</h1>
                <span class="app-subtitle">ìì‹ ë§Œì˜ ì†Œì„¤ì„ ë§Œë“¤ì–´ê°€ë©°</span>
                <!-- Survey Feedback Icons -->
                <div class="survey-icons">
                    <button id="survey-thumbs-up" class="survey-icon-btn" title="Like this service">
                        <span class="thumbs-icon">ğŸ‘</span>
                    </button>
                    <button id="survey-thumbs-down" class="survey-icon-btn" title="Dislike this service">
                        <span class="thumbs-icon">ğŸ‘</span>
                    </button>
                </div>
            </div>
            <div class="header-center">
                <!-- Generation Status Indicator -->
                <div id="status-indicator" class="status-idle">
                    <span class="status-dot"></span>
                    <span class="status-text">ì¤€ë¹„ë¨</span>
                </div>
            </div>
            <div class="header-right">
                <!-- Remaining Generations Display -->
                <div id="remaining-generations" class="remaining-generations hidden">
                    <span id="remaining-count">0</span>íšŒ ë‚¨ìŒ
                </div>
                <!-- Remaining Image Generations Display -->
                <div id="remaining-image-generations" class="remaining-image-generations hidden">
                    <span id="remaining-image-count">0</span>ì¥ ë‚¨ìŒ
                </div>
                <!-- Word Count Display -->
                <div class="word-count">
                    <span id="word-count">0</span>ë‹¨ì–´
                </div>
                <!-- Character Count Display -->
                <div class="char-count">
                    <span id="char-count">0</span>ê¸€ì
                </div>
            </div>
        </header>

        <!-- ========================================
             MOBILE GENERATE BUTTONS - Visible only on mobile
             ======================================== -->
        <div class="mobile-generate-buttons">
            <button id="btn-generate-mobile" class="btn btn-generate" title="ì»¤ì„œ ìœ„ì¹˜ì—ì„œ ìƒì„±">
                âœ¨ ìƒì„±
            </button>
            <button id="btn-generate-image-mobile" class="btn btn-generate-image" title="ë¬¸ë§¥ì—ì„œ ì´ë¯¸ì§€ ìƒì„±">
                ğŸ¨ ì´ë¯¸ì§€
            </button>
            <button id="btn-stop-mobile" class="btn btn-stop hidden" title="ìƒì„± ì¤‘ì§€">
                â¹ ì¤‘ì§€
            </button>
            <!-- Mobile Survey Icons -->
            <div class="mobile-survey-icons">
                <button id="survey-thumbs-up-mobile" class="survey-icon-btn mobile" title="ì„œë¹„ìŠ¤ ì¢‹ì•„ìš”">
                    <span class="thumbs-icon">ğŸ‘</span>
                </button>
                <button id="survey-thumbs-down-mobile" class="survey-icon-btn mobile" title="ì„œë¹„ìŠ¤ ì‹«ì–´ìš”">
                    <span class="thumbs-icon">ğŸ‘</span>
                </button>
            </div>
        </div>

        <!-- ========================================
             MAIN CONTENT AREA
             ======================================== -->
        <main class="main-content">
            
            <!-- ========================================
                 LEFT SIDEBAR - Generation Settings
                 ======================================== -->
            <aside class="sidebar sidebar-left">
                <div class="sidebar-section">
                    <h3 class="section-title">âš™ï¸ ìƒì„± ì„¤ì •</h3>
                    
                    <!-- Model Selection -->
                    <div class="setting-group">
                        <label for="model-select">AI ëª¨ë¸</label>
                        <select id="model-select" class="setting-input">
                            <option value="gemini-2.5-pro">Gemini 2.5 Pro</option>
                            <option value="gemini-2.5-flash">Gemini 2.5 Flash</option>
                            <option value="gemini-3-pro-preview">Gemini 3 Pro Preview</option>
                        </select>
                    </div>

                    <!-- Temperature Control -->
                    <div class="setting-group">
                        <label for="temperature-slider">
                            ì°½ì˜ì„±: <span id="temperature-value">0.8</span>
                        </label>
                        <input type="range" id="temperature-slider" class="setting-slider" 
                               min="0" max="2" step="0.1" value="0.8">
                        <div class="slider-labels">
                            <span>ì •í™•í•¨</span>
                            <span>ì°½ì˜ì </span>
                        </div>
                    </div>

                    <!-- Max Words Control -->
                    <div class="setting-group">
                        <label for="max-words-slider">
                            ìµœëŒ€ ë‹¨ì–´ ìˆ˜: <span id="max-words-value">150</span>
                        </label>
                        <input type="range" id="max-words-slider" class="setting-slider" 
                               min="50" max="500" step="25" value="150">
                        <div class="slider-labels">
                            <span>ì§§ê²Œ</span>
                            <span>ê¸¸ê²Œ</span>
                        </div>
                    </div>

                    <!-- Paragraph Length -->
                    <div class="setting-group">
                        <label for="paragraph-length">ë¬¸ë‹¨ ê¸¸ì´</label>
                        <select id="paragraph-length" class="setting-input">
                            <option value="short">ì§§ìŒ (2-3ë¬¸ì¥)</option>
                            <option value="medium" selected>ë³´í†µ (4-6ë¬¸ì¥)</option>
                            <option value="long">ê¸´ (7ë¬¸ì¥ ì´ìƒ)</option>
                        </select>
                    </div>

                    <!-- Language Selection -->
                    <div class="setting-group">
                        <label for="language-select">ì–¸ì–´</label>
                        <select id="language-select" class="setting-input">
                            <option value="EN" selected>English</option>
                            <option value="KR">í•œêµ­ì–´ (Korean)</option>
                            <option value="JP">æ—¥æœ¬èª (Japanese)</option>
                        </select>
                    </div>
                </div>

                <div class="sidebar-section">
                    <h3 class="section-title">ğŸ“š ìŠ¤í† ë¦¬ ì„¤ì •</h3>
                    
                    <!-- Genre Selection -->
                    <div class="setting-group">
                        <label for="genre-select">ì¥ë¥´</label>
                        <select id="genre-select" class="setting-input">
                            <option value="fantasy">íŒíƒ€ì§€</option>
                            <option value="scifi">SF</option>
                            <option value="romance">ë¡œë§¨ìŠ¤</option>
                            <option value="mystery">ë¯¸ìŠ¤í„°ë¦¬/ìŠ¤ë¦´ëŸ¬</option>
                            <option value="horror">í˜¸ëŸ¬</option>
                            <option value="literary">ë¬¸í•™</option>
                            <option value="adventure">ëª¨í—˜</option>
                            <option value="historical">ì—­ì‚¬</option>
                        </select>
                    </div>

                    <!-- Writing Style -->
                    <div class="setting-group">
                        <label for="style-select">ì‘ë¬¸ ìŠ¤íƒ€ì¼</label>
                        <select id="style-select" class="setting-input">
                            <option value="descriptive">ë¬˜ì‚¬ì ì´ê³  ëª°ì…ê° ìˆê²Œ</option>
                            <option value="concise">ê°„ê²°í•˜ê³  ì§ì ‘ì ìœ¼ë¡œ</option>
                            <option value="poetic">ì‹œì ì´ê³  ì„œì •ì ìœ¼ë¡œ</option>
                            <option value="dialogue-heavy">ëŒ€í™” ì¤‘ì‹¬ìœ¼ë¡œ</option>
                            <option value="action">ì•¡ì…˜ ì¤‘ì‹¬ìœ¼ë¡œ</option>
                            <option value="introspective">ë‚´ë©´ íƒêµ¬ì ìœ¼ë¡œ</option>
                        </select>
                    </div>

                    <!-- Tone Selection -->
                    <div class="setting-group">
                        <label for="tone-select">ë¶„ìœ„ê¸°</label>
                        <select id="tone-select" class="setting-input">
                            <option value="neutral">ì¤‘ë¦½ì </option>
                            <option value="dark">ì–´ë‘¡ê³  ì‚¬ì‹¤ì </option>
                            <option value="light">ë°ê³  í¬ë§ì </option>
                            <option value="humorous">ìœ ë¨¸ëŸ¬ìŠ¤</option>
                            <option value="dramatic">ê·¹ì </option>
                            <option value="mysterious">ì‹ ë¹„ë¡œìš´</option>
                        </select>
                    </div>

                    <!-- POV Selection -->
                    <div class="setting-group">
                        <label for="pov-select">ì‹œì </label>
                        <select id="pov-select" class="setting-input">
                            <option value="third-limited">3ì¸ì¹­ ì œí•œì </option>
                            <option value="third-omni">3ì¸ì¹­ ì „ì§€ì </option>
                            <option value="first">1ì¸ì¹­</option>
                            <option value="second">2ì¸ì¹­</option>
                        </select>
                    </div>
                </div>

                <div class="sidebar-section">
                    <h3 class="section-title"></h3>
                </div>
            </aside>

            <!-- ========================================
                 CENTER - Main Text Editor
                 ======================================== -->
            <div class="editor-container">
                <!-- Toolbar -->
                <div class="editor-toolbar">
                    <div class="toolbar-left">
                        <button id="btn-new" class="toolbar-btn toolbar-btn-compact" title="ìƒˆ ë¬¸ì„œ">
                            ğŸ“„
                        </button>
                        <button id="btn-save" class="toolbar-btn toolbar-btn-compact" title="ë¬¸ì„œ ì €ì¥">
                            ğŸ’¾
                        </button>
                        <button id="btn-load" class="toolbar-btn toolbar-btn-compact" title="ë¬¸ì„œ ë¶ˆëŸ¬ì˜¤ê¸°">
                            ğŸ“‚
                        </button>
                        <div class="toolbar-separator"></div>
                        <button id="btn-undo" class="toolbar-btn toolbar-btn-compact" title="ì‹¤í–‰ ì·¨ì†Œ (Ctrl+Z)">
                            â†¶
                        </button>
                        <button id="btn-redo" class="toolbar-btn toolbar-btn-compact" title="ë‹¤ì‹œ ì‹¤í–‰ (Ctrl+Y)">
                            â†·
                        </button>
                    </div>
                    <div class="toolbar-center">
                        <!-- Generation Controls -->
                        <button id="btn-generate" class="btn btn-generate" title="ì»¤ì„œ ìœ„ì¹˜ì—ì„œ ìƒì„± (Ctrl+Enter)">
                            âœ¨ ìƒì„±
                        </button>
                        <button id="btn-generate-image" class="btn btn-generate-image" title="ë¬¸ë§¥ì—ì„œ ì´ë¯¸ì§€ ìƒì„±">
                            ğŸ¨ ì´ë¯¸ì§€
                        </button>
                        <button id="btn-stop" class="btn btn-stop hidden" title="ìƒì„± ì¤‘ì§€ (Escape)">
                            â¹ ì¤‘ì§€
                        </button>
                    </div>
                    <div class="toolbar-right">
                        <button id="btn-fullscreen" class="toolbar-btn toolbar-btn-compact" title="ì „ì²´í™”ë©´ ì „í™˜">
                            â›¶
                        </button>
                    </div>
                </div>

                <!-- Text Editor Area -->
                <div class="editor-wrapper">
                    <!-- Loading Overlay -->
                    <div id="loading-overlay" class="loading-overlay hidden">
                        <div class="spinner"></div>
                        <span class="loading-text">ìƒì„± ì¤‘...</span>
                    </div>

                    <!-- Main Text Area (contenteditable for real-time formatting) -->
                    <div id="editor-textarea" 
                         class="editor-textarea" 
                         contenteditable="true"
                         data-placeholder="ì—¬ê¸°ì„œ ì´ì•¼ê¸°ë¥¼ ì‹œì‘í•˜ê±°ë‚˜, ìƒì„± ë²„íŠ¼ì„ ëˆŒëŸ¬ AIê°€ ë„ì…ë¶€ë¥¼ ì ìŠµë‹ˆë‹¤.
ê·¸ ì™¸ AIì—ê²Œ ì§ì ‘ ì§€ì‹œí•  ë‚´ìš©ì€ (OOC: ... )ë¡œ ì ì–´ì£¼ì„¸ìš”.
ì˜ˆì‹œ: (OOC: ê¹€í˜„ìˆ˜ êµìˆ˜ë‹˜ê»˜ì„  ë…¸ë²¨í‰í™”ìƒì— ì…ìƒí•˜ê²Œ ë©ë‹ˆë‹¤."></div>
                </div>

                <!-- Editor Footer -->
                <div class="editor-footer">
                    <div class="footer-left">
                        <span id="cursor-position">1ì¤„, 1ì—´</span>
                    </div>
                    <div class="footer-center">
                        <span id="generation-info"></span>
                    </div>
                    <div class="footer-right">
                        <span id="autosave-status">ìë™ ì €ì¥ë¨</span>
                    </div>
                </div>
            </div>

            <!-- ========================================
                 RIGHT SIDEBAR - Formatting Options
                 ======================================== -->
            <aside class="sidebar sidebar-right">
                <div class="sidebar-section">
                    <h3 class="section-title">ğŸ¨ í…ìŠ¤íŠ¸ ì„œì‹</h3>
                    
                    <!-- Font Family -->
                    <div class="setting-group">
                        <label for="font-family">ê¸€ê¼´</label>
                        <select id="font-family" class="setting-input">
                            <option value="'Merriweather', serif">Merriweather</option>
                            <option value="'Lora', serif">Lora</option>
                            <option value="'Crimson Text', serif">Crimson Text</option>
                            <option value="'Georgia', serif">Georgia</option>
                            <option value="'Times New Roman', serif">Times New Roman</option>
                            <option value="'Noto Sans JP', sans-serif">Noto Sans JP</option>
                            <option value="'Noto Sans KR', sans-serif">Noto Sans KR</option>
                        </select>
                    </div>

                    <!-- Font Size -->
                    <div class="setting-group">
                        <label for="font-size-slider">
                            ê¸€ì í¬ê¸°: <span id="font-size-value">18</span>px
                        </label>
                        <input type="range" id="font-size-slider" class="setting-slider" 
                               min="12" max="28" step="1" value="18">
                    </div>

                    <!-- Line Height -->
                    <div class="setting-group">
                        <label for="line-height-slider">
                            ì¤„ ê°„ê²©: <span id="line-height-value">1.8</span>
                        </label>
                        <input type="range" id="line-height-slider" class="setting-slider" 
                               min="1.2" max="2.5" step="0.1" value="1.8">
                    </div>

                    <!-- Paragraph Spacing -->
                    <div class="setting-group">
                        <label for="paragraph-spacing-slider">
                            ë¬¸ë‹¨ ê°„ê²©: <span id="paragraph-spacing-value">1.5</span>em
                        </label>
                        <input type="range" id="paragraph-spacing-slider" class="setting-slider" 
                               min="0.5" max="3" step="0.25" value="1.5">
                    </div>
                </div>

                <div class="sidebar-section">
                    <h3 class="section-title">ğŸŒˆ ê°•ì¡° ìƒ‰ìƒ</h3>
                    
                    <!-- Dialogue Color (Double Quotes) -->
                    <div class="setting-group color-group">
                        <label for="dialogue-color">
                            ëŒ€í™” ("...") ìƒ‰ìƒ
                        </label>
                        <div class="color-picker-wrapper">
                            <input type="color" id="dialogue-color" class="color-picker" value="#e67e22">
                            <span class="color-preview" style="background-color: #e67e22;"></span>
                        </div>
                    </div>

                    <!-- Thoughts Color (Single Quotes) -->
                    <div class="setting-group color-group">
                        <label for="thoughts-color">
                            ìƒê° ('...') ìƒ‰ìƒ
                        </label>
                        <div class="color-picker-wrapper">
                            <input type="color" id="thoughts-color" class="color-picker" value="#3498db">
                            <span class="color-preview" style="background-color: #3498db;"></span>
                        </div>
                    </div>

                    <!-- Emphasis Color -->
                    <div class="setting-group color-group">
                        <label for="emphasis-color">
                            ê°•ì¡° (*...*) ìƒ‰ìƒ
                        </label>
                        <div class="color-picker-wrapper">
                            <input type="color" id="emphasis-color" class="color-picker" value="#9b59b6">
                            <span class="color-preview" style="background-color: #9b59b6;"></span>
                        </div>
                    </div>

                    <!-- Text Color -->
                    <div class="setting-group color-group">
                        <label for="text-color">
                            ê¸°ë³¸ ê¸€ì ìƒ‰ìƒ
                        </label>
                        <div class="color-picker-wrapper">
                            <input type="color" id="text-color" class="color-picker" value="#2c3e50">
                            <span class="color-preview" style="background-color: #2c3e50;"></span>
                        </div>
                    </div>

                    <!-- Background Color -->
                    <div class="setting-group color-group">
                        <label for="bg-color">
                            ë°°ê²½ ìƒ‰ìƒ
                        </label>
                        <div class="color-picker-wrapper">
                            <input type="color" id="bg-color" class="color-picker" value="#fdf6e3">
                            <span class="color-preview" style="background-color: #fdf6e3;"></span>
                        </div>
                    </div>
                </div>

                <div class="sidebar-section">
                    <h3 class="section-title">ğŸ“‹ í”„ë¦¬ì…‹</h3>
                    
                    <!-- Theme Presets -->
                    <div class="preset-buttons">
                        <button class="preset-btn" data-preset="sepia">ğŸ“œ ì„¸í”¼ì•„</button>
                        <button class="preset-btn" data-preset="dark">ğŸŒ™ ë‹¤í¬</button>
                        <button class="preset-btn" data-preset="light">â˜€ï¸ ë¼ì´íŠ¸</button>
                        <button class="preset-btn" data-preset="paper">ğŸ“„ ì¢…ì´</button>
                    </div>
                </div>

                <div class="sidebar-section">
                    <h3 class="section-title">ğŸ’¾ ë™ì‘</h3>
                    <div class="action-buttons">
                        <button id="btn-export-txt" class="action-btn">.txtë¡œ ë‚´ë³´ë‚´ê¸°</button>
                        <button id="btn-export-html" class="action-btn">.htmlë¡œ ë‚´ë³´ë‚´ê¸°</button>
                        <button id="btn-reset-settings" class="action-btn">ì„¤ì • ì´ˆê¸°í™”</button>
                    </div>
                </div>
            </aside>
        </main>

        <!-- ========================================
             ALERT CONTAINER - For Error Messages
             ======================================== -->
        <div id="alert-container" class="alert-container"></div>
    </div>

    <!-- ========================================
         HIDDEN FILE INPUT FOR LOADING
         ======================================== -->
    <input type="file" id="file-input" accept=".txt,.json" style="display: none;">

    <!-- ========================================
         SCRIPTS
         ======================================== -->
    <script src="js/crypto.js"></script>
    <script src="js/storage.js"></script>
    <script src="js/formatter.js"></script>
    <script src="js/ratelimit.js"></script>
    <script src="js/gemini.js"></script>
    <script src="js/app.js"></script>
    <script src="js/survey.js"></script>
    
    <!-- Mobile Button Synchronization Script -->
    <script>
        (function() {
            'use strict';
            
            // Wait for DOM to be ready
            document.addEventListener('DOMContentLoaded', function() {
                // Get references to desktop and mobile buttons
                const btnGenerate = document.getElementById('btn-generate');
                const btnGenerateImage = document.getElementById('btn-generate-image');
                const btnStop = document.getElementById('btn-stop');
                
                const btnGenerateMobile = document.getElementById('btn-generate-mobile');
                const btnGenerateImageMobile = document.getElementById('btn-generate-image-mobile');
                const btnStopMobile = document.getElementById('btn-stop-mobile');
                
                // Sync mobile buttons with desktop buttons
                if (btnGenerateMobile && btnGenerate) {
                    btnGenerateMobile.addEventListener('click', function() {
                        btnGenerate.click();
                    });
                }
                
                if (btnGenerateImageMobile && btnGenerateImage) {
                    btnGenerateImageMobile.addEventListener('click', function() {
                        btnGenerateImage.click();
                    });
                }
                
                if (btnStopMobile && btnStop) {
                    btnStopMobile.addEventListener('click', function() {
                        btnStop.click();
                    });
                }
                
                // Observe class changes on desktop buttons to sync visibility with mobile
                const observer = new MutationObserver(function(mutations) {
                    mutations.forEach(function(mutation) {
                        if (mutation.attributeName === 'class') {
                            const target = mutation.target;
                            
                            // Sync Generate button visibility (only hidden class)
                            if (target === btnGenerate && btnGenerateMobile) {
                                if (target.classList.contains('hidden')) {
                                    btnGenerateMobile.classList.add('hidden');
                                } else {
                                    btnGenerateMobile.classList.remove('hidden');
                                }
                            }
                            
                            // Sync Generate Image button visibility (only hidden class)
                            if (target === btnGenerateImage && btnGenerateImageMobile) {
                                if (target.classList.contains('hidden')) {
                                    btnGenerateImageMobile.classList.add('hidden');
                                } else {
                                    btnGenerateImageMobile.classList.remove('hidden');
                                }
                            }
                            
                            // Sync Stop button visibility (only hidden class)
                            if (target === btnStop && btnStopMobile) {
                                if (target.classList.contains('hidden')) {
                                    btnStopMobile.classList.add('hidden');
                                } else {
                                    btnStopMobile.classList.remove('hidden');
                                }
                            }
                        }
                    });
                });
                
                // Start observing desktop buttons for class changes
                const observerConfig = { attributes: true, attributeFilter: ['class'] };
                
                if (btnGenerate) observer.observe(btnGenerate, observerConfig);
                if (btnGenerateImage) observer.observe(btnGenerateImage, observerConfig);
                if (btnStop) observer.observe(btnStop, observerConfig);
                
                // Mobile Survey Icons Synchronization
                const surveyThumbsUp = document.getElementById('survey-thumbs-up');
                const surveyThumbsDown = document.getElementById('survey-thumbs-down');
                const surveyThumbsUpMobile = document.getElementById('survey-thumbs-up-mobile');
                const surveyThumbsDownMobile = document.getElementById('survey-thumbs-down-mobile');
                
                // Sync mobile survey buttons with desktop survey buttons
                if (surveyThumbsUpMobile && surveyThumbsUp) {
                    surveyThumbsUpMobile.addEventListener('click', function() {
                        surveyThumbsUp.click();
                    });
                }
                
                if (surveyThumbsDownMobile && surveyThumbsDown) {
                    surveyThumbsDownMobile.addEventListener('click', function() {
                        surveyThumbsDown.click();
                    });
                }
            });
        })();
    </script>
</body>

</html>
